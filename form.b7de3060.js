function e(){let e="form",t=document.getElementById("view-form"),n=document.getElementById("view-success"),o=document.getElementById("view-error");function r(r){e=r,t.classList.toggle("hidden","form"!==e),n.classList.toggle("hidden","success"!==e),o.classList.toggle("hidden","error"!==e)}let i=(()=>{let e=document.getElementById("form");if(!(e instanceof HTMLFormElement))throw Error("Expected a <form> tag with id 'form' in DOM");return e})(),d=(()=>{let e=document.getElementById("image_upload");if(!(e instanceof HTMLInputElement))throw Error("Expected an <input> tag with id 'image_upload' in DOM");return e})(),a=(()=>{let e=document.getElementById("upload_preview");if(!(e instanceof HTMLImageElement))throw Error("Expected an <img> tag with id 'upload_preview' in DOM");return e})(),l=(()=>{let e=document.getElementById("submit");if(!(e instanceof HTMLButtonElement))throw Error("Expected a <button> tag with id 'submit' in DOM");return e})();function c(){l.disabled=!i.checkValidity()}function s(){let e=d.files;if(null!==e&&0!==e.length){if(e.length>1)throw Error(`Expected one uploaded file, found ${e.length}`);a.src=URL.createObjectURL(e[0])}}async function u(e){e.preventDefault(),console.log("submit");let t=new FormData(i),n=t.get("image_upload"),o=n.name;if(t.append("filename",o),t.delete("image_upload"),console.log(t),n)try{let e=await fetch("https://api.biljettstrejk.se/api/register_fine",{method:"POST",body:t});if(!e.ok)return void r("error");let o=(await e.json()).upload_url;if(!(await fetch(o,{method:"PUT",headers:{"Content-Type":n.type},body:n})).ok)return void r("error");r("success")}catch(e){r("error"),console.error(e)}}d.addEventListener("change",s),s(),l.addEventListener("click",u),i.addEventListener("input",c),i.addEventListener("change",c)}"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",e);
//# sourceMappingURL=form.b7de3060.js.map
